## 什么是全链路压测
> 全链路压测在阿里、美团、京东、字节等大厂已经有了广泛的实践，就不过多赘述
* 一句话介绍：全链路压测是基于线上真实环境和实际业务场景，通过模拟海量的用户请求，来对整个系统进行压力测试。
* 必要性：当服务调用链路趋向复杂时，各个环节的瓶颈都可能会导致服务不可用。而在生产环境压测，可以最大程度地模拟真实流量，提前发现并解决问题，减少系统故障的发生。

## 全链路压测的核心功能
* 数据构造：mock数据，使数据更加接近真实数据
* 流量染色：为了区分业务流量和压测流量，一般会在highLight(HTTP的Header或RPC的上下文)中添加标识。目的是为了防止污染业务数据
* 压测标透传：对于线程调用一般使用highLight(ThreadLocal、InheritableThreadLocal和阿里的TTL)。对于跨服务调用，一般是使用highLight(上下文)传递
* 数据隔离：数据隔离是指将业务数据和压测数据在存储层进行隔离，常见的方案有highLight(影子库、影子表、影子Topic、影子缓存)等
* 链路监控：链路监控是指对服务调用进行全链路的监控，常见的全链路监控框架比如highLight(SkyWalking、Zabbix、Pinpoint)等
* 压测熔断：压测熔断是指在压测过程中，当系统检测到异常情况时，highLight(会主动中止或降低压测流量)，保证生产环境的稳定性。主要通过highLight(响应RT、内存使用率、HTTP错误)等指标来判断是否进行熔断

## Agent
在全链路压测中，Agent的主要职责有以下几点
* 识别压测标
* 压测标透传
* 影子库影子表存储
* 链路监控
* 熔断通知
  
接下来将对以上几点做highLight(代码级别)的讲解，进入[Quick Start](/stress_testing_agent/md/quick_start.md)


## 参考资料
* [全链路压测平台（Quake）在美团中的实践](https://zhuanlan.zhihu.com/p/45090598)
* [阿里双11：「线上全链路压测」完整经验分享](https://cloud.tencent.com/developer/article/1825854)
* [字节跳动全链路压测(Rhino)的实践](https://juejin.cn/post/6882548316463169543?searchId=20241204170250B3A1693184E63B92947B)
* [高德全链路压测——精准控压的建设实践](https://juejin.cn/post/6897098266250903560?searchId=20241204170250B3A1693184E63B92947B)



